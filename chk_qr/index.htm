<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <script src="https://unpkg.com/@zxing/library@latest"></script>
</head>
<body>

    <input type="file" id="u" accept="image/*">
    <p id="r">結果を表示します</p>

    <script>
        const reader = new ZXing.BrowserPDF417Reader();
        const r = document.getElementById('r');

        document.getElementById('u').onchange = (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const url = URL.createObjectURL(file);
            const img = new Image();
            
            img.onload = () => {
                reader.decodeFromImageElement(img)
                    .then(result => {
                        r.innerText = result.text;
                        URL.revokeObjectURL(url);
                    })
                    .catch(err => {
                        r.innerText = "検出失敗: " + err;
                        URL.revokeObjectURL(url);
                    });
            };
            img.src = url;
        };
    </script>
</body>
</html>
